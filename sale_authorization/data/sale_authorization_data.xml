<?xml version="1.0" encoding="UTF-8"?>
<odoo>
        <!--new action filter quotations than are authorized-->
        <record id="action_sale_autorization" model="ir.actions.act_window">
            <field name="name">Quotation Authorization</field>
            <field name="domain">[('state', '!=', 'sale'),('authorized', '=', True)]</field>
            <field name="res_model">sale.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <!--new menu-->
        <menuitem id="menu_sales_orders_quotation_authorized" name="Quotation Authorized" parent="sale.sale_order_menu" action="action_sale_autorization" sequence="1"/>
        
        <record id="sale.action_quotations" model="ir.actions.act_window">
            <field name="domain">[('state', '!=', 'sale'),('authorized', '=', False)]</field>
        </record>

        <!--added new menus in the crm module that filter the same way as the sales module-->

        <menuitem id="crm_menu_sales_authorized" name="Quotation Authorized" parent="crm.crm_menu_sales" action="action_sale_autorization" sequence="2"/>

        <menuitem id="crm_menu_sales_orders" name="Sale Order" parent="crm.crm_menu_sales" action="sale.action_orders" sequence="3"/>

        <record id="sale_crm.sale_order_menu_quotations_crm" model="ir.ui.menu">
            <field name="name">Quot</field>
        </record>

    <!--Modified the original action for this new filter-->
    <record id="sale_crm.sale_action_quotations" model="ir.actions.act_window">
        <field name="domain">[('opportunity_id', '=', active_id),('authorized', '=', False)]</field>
        <field name="context">{'search_default_opportunity_id': [active_id], 'default_opportunity_id': active_id}</field>
    </record>

    <!--This new action is for new button Quotation Autorizad that there is in crm inside of pipeline form-->
    <record id="sale_action_quotations_authorized" model="ir.actions.act_window">
        <field name="name">Quotation Authorized pipeline</field>
        <field name="domain">[('opportunity_id', '=', active_id),('state', '!=', 'sale'),('authorized', '=', True)]</field>
        <field name="context">{'search_default_opportunity_id': [active_id], 'default_opportunity_id': active_id}</field>
        <field name="res_model">sale.order</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

</odoo>
