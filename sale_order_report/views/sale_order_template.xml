<?xml version="1.0"?>
<odoo>
    <template id="report_sale_order_inherit_external_for_iho" inherit_id="sale_stock.report_saleorder_document_inherit_sale_stock">
        <xpath expr="//div[1]" position="replace">
        </xpath>
    </template>
    <template id="report_sale_order_external_for_iho" inherit_id="sale.report_saleorder_document">
        <xpath expr="//t/t[1]" position="replace">
            <t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})" />
            <t t-call="web.html_container">
                <div class="header">
                    <div/>
                </div>
                <t t-call="web.internal_layout">                    
                    <div class="page">
                        <div style="height: 80px; width: 150px;">
                            <span t-field="res_company.logo" t-options="{'widget': 'image'}" role="img" t-att-aria-label="'Logo of %s' % res_company.name" t-att-title="res_company.name"/><br/><br/>
                        </div>
                        <div class="row" style="padding-top:16px;padding-button:16px;">
                            <div class="col pull-left">
                                <table style="font-size:15px;line-height: 16px;">
                                    <tr>
                                        <td style="color: gray;"><strong>Partner: </strong></td>
                                        <td><span t-field="doc.partner_id"/></td>
                                    </tr>
                                    <tr>
                                        <td style="color: gray;"><strong>Address: </strong></td>
                                        <td><span t-field="doc.partner_id.street"/></td>
                                    </tr>
                                    <tr>
                                        <td style="color: gray;"><strong>Email: </strong></td>
                                        <td><span t-field="doc.partner_id.email"/></td>
                                    </tr>
                                    <tr>
                                        <td style="color: gray;"><strong>Phone: </strong></td>
                                        <td><span t-field="doc.partner_id.phone"/></td>
                                    </tr>
                                    <tr>
                                        <td style="color: gray;"><strong>Quotation: &amp;nbsp;</strong></td>
                                        <td><span t-esc="doc.name"/></td>
                                    </tr>
                                    <tr>
                                        <td style="color: gray;"><strong>Date: </strong></td>
                                        <td><span t-field="doc.create_date"/></td>
                                    </tr>
                                </table>
                                <br/>
                            </div>
                        </div>
                        <!-- Is there a discount on at least one line? -->
                        <div class="row">
                            <br/>
                            <t t-set="product_freight" t-value="doc.get_product_freight()"/>
                            <table class="table table-bordered" style="font-size:12px; padding-left:20px;">
                                <thead>
                                    <tr style="background-color: #F04E23; color: #ffffff;">
                                        <th class="text-left" style="width: 10px;"><strong>Item</strong></th>
                                        <th class="text-center"><strong>Quantity</strong></th>
                                        <th class="text-center"><strong>Code</strong></th>
                                        <th class="text-left"><strong>Description</strong></th>
                                        <th class="text-center" t-if="doc.find_images() != False"><strong>photo</strong></th>
                                        <th class="text-right"><strong>Unit Price</strong></th>
                                        <th class="text-right"><strong>Total Price</strong></th>
                                    </tr>
                                </thead>
                                <tbody class="sale_tbody">
                                    <t t-set="current_subtotal" t-value="0"/>
                                    <t t-set="row_count" t-value="1"/>
                                    <t t-foreach="doc.order_line" t-as="line">
                                        <t t-if="product_freight['product_id'] != line.product_id.id">
                                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                            <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>
                                            <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                                                <t t-if="not line.display_type">
                                                    <td><span t-esc="row_count"/></td>
                                                    <td class="text-right">
                                                        <span t-esc="int(line.product_uom_qty)"/>
                                                    </td>
                                                    <td><span t-field="line.product_id.code"/></td>
                                                    <td><span t-field="line.name"/></td>
                                                    <td t-if="doc.find_images() != False"><span t-if="line.image_sol" t-field="line.image_sol" t-options="{'widget': 'image'}" role="img"/></td>
                                                    <td class="text-right">
                                                        <span 
                                                            t-esc="line.price_unit"
                                                            t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'
                                                        />
                                                    </td>
                                                    <td class="text-right o_price_total">
                                                        <span t-field="line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                                        <span t-field="line.price_total" groups="account.group_show_line_subtotals_tax_included"/>
                                                    </td>
                                                </t>
                                                <t t-if="line.display_type == 'line_note'">
                                                    <td t-att-colspan="colspan">
                                                        <span t-field="line.name"/>
                                                    </td>
                                                </t>
                                            </tr>
                                            <t t-if="current_section and (line_last or doc.order_line[line_index+1].display_type == 'line_section')">
                                                <tr class="is-subtotal text-right">
                                                    <td t-att-colspan="colspan">
                                                        <strong class="mr16">Subtotal</strong>
                                                        <span
                                                            t-esc="current_subtotal"
                                                            t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'
                                                        />
                                                    </td>
                                                </tr>
                                            </t>
                                            <tr t-if="line.display_type == 'line_section'">
                                                <td colspan="7">
                                                    <span t-if="line.image_sol" t-field="line.image_sol" t-options="{'widget': 'image'}" role="img"/>
                                                </td>
                                            </tr>
                                            <t t-if="not line.display_type" t-set="row_count" t-value="row_count+1"/>
                                        </t>
                                    </t>
                                    <t t-foreach="doc.sale_order_option_ids" t-as="line_o">
                                        <t t-if="line_o">
                                            <tr>
                                                <td colspan="4">Optional Products</td>
                                            </tr>
                                            <tr>
                                                <th class="text-center"><strong>Quantity</strong></th>
                                                <th class="text-center"><strong>Code</strong></th>
                                                <th class="text-left"><strong>Description</strong></th>
                                                <th class="text-right"><strong>Unit Price</strong></th>
                                            </tr>
                                            <tr>
                                                <td><span t-field="line_o.quantity"/></td>
                                                <td><span t-field="line_o.product_id.code"/></td>
                                                <td><span t-field="line_o.name"/></td>
                                                <td><span t-field="line_o.price_unit"/></td>
                                            </tr>
                                        </t>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                        <div name="payment_term"/>
                        <div class="row col-6 pull-right">
                            <table class="table table-xs table-condensed" style="font-size:12px;line-height: 2px;">
                                <tr class="border-black o_subtotal">
                                    <td><strong>Subtotal</strong></td>
                                    <td class="text-right">
                                        <span t-esc="float(doc.amount_untaxed - product_freight['unit_price']) if product_freight['unit_price'] else doc.amount_untaxed" t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/>
                                    </td>
                                </tr>
                                <tr class="border-black o_total">
                                    <td><strong>Total</strong></td>
                                    <td class="text-right">
                                         <span t-field="doc.amount_total"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row">
                            <div class="col">
                                <strong><h6><u>Terms and Conditions for the Sale of goods supplied by IHO.</u></h6></strong><br/>
                                <strong><h6>Delivery time</h6></strong><br/>
                                <div style="font-size:11px; line-height: 1px;">
                                    <p>* Delivery time: &amp;nbsp;<strong t-esc="doc.delivery"/> approximately from the receipt of the purchase order and advance payment.</p>
                                    <p>* Product <strong t-field="doc.incoterm"/> &amp;nbsp; in &amp;nbsp;<strong t-esc="doc.warehouse_id.partner_id.city"/></p><br/>
                                </div>
                                <strong><h6>Payment</h6></strong>
                                <div style="font-size:11px; line-height: 1px;">
                                    <p>* All prices are expressed in&amp;nbsp; American dollars</p>
                                    <p>* Prices plus tax. </p>                                    
                                    <t t-if="doc.currency_id.name == 'USD'">
                                        <p>* In case of paying in pesos, the bank exchange rate on sale will be taken as reference, on the day of payment. </p>
                                    </t>
                                    <p>*  Payment conditions:&amp;nbsp;<strong t-field="doc.payment_term_id"/>.</p>
                                    <p>* Payments must be made within the first 10 calendar days after the corresponding invoice has been issued. </p>
                                    <p>* IHO reserves the right not to deliver and install in case the Client is late in their payments. </p>
                                    <p>* In case that for reasons attributable to the client, the product can not be delivered, it does not limit the collection thereof. </p>
                                    <p>* In case of delays in payments to products already delivered, a moratorium charge will be made at a rate of 1% per month and up to 10% maximum. </p>
                                </div>
                                <strong><h6>Cancellations</h6></strong>
                                <div style="font-size:11px; line-height: 1px;">
                                    <p>* After the first 5 calendar days upon receipt of your purchase order, no changes or cancellations will be accepted.</p>
                                </div>
                                <strong><h6>Guarantee</h6></strong>
                                <div style="font-size:11px;">
                                    <span>* IHO Espacios, guarantees all its products against defects in materials and / or manufacture according to the specific product warranty that will be issued directly by each manufacturer, which is delivered to the Customer. </span><br/>
                                    <span>* During the guarantee period, any defect will be repaired by IHO Spaces or by contracted personnel, by means of composing or resposing the defective part (s). </span><br/>
                                    <span>* The guarantee does not cover any of the following cases: a) tapestries with client's cloths, although the same has been accepted by the manufacturer for this purpose. B) Damage to paints or enamels caused by entrainment, negligence or misuse of the product. C) Damages caused to products due to wrong use, storage, installation, inappropriate treatment, influences due to climatic causes, negligence by the customer's personnel or by acts of third parties. </span><br/>
                                    <span>* Warranty replacements are not grounds for withholding payments. Only the amount corresponding to the affected products could be retained. </span><br/><br/>
                                </div>
                                <strong><h6>Services</h6></strong>
                                <div style="font-size:11px;">
                                    <span>* This quote includes: Freight, Maneuver, Download, location and installation according to the approved layout at the time of the order and withdrawal of Packages.</span><br/>
                                    <span>* These prices <strong>DO NOT</strong> include storage or reconfigurations during the installation process.</span><br/>
                                    <span>* It is the responsibility of the client to process the corresponding permits for the entrance of IHO Espacios workers, as well as to facilitate the use of forklifts or service elevators. This quote contemplates that IHO personnel have access to the forklift.</span><br/>
                                </div>
                                <strong><h6>Generals</h6></strong>
                                <div style="font-size:11px; line-height: 1px;">
                                    <p>* To place an order requires a purchase order or a signed contract, this signed quote, the signed finish and the advance payment. </p>
                                    <p>* Acceptance of this quote implies acceptance of these terms and conditions. </p>
                                    <p>* Quotation valid until <strong t-field="doc.validity_date"/>.</p>
                                    <p>* Prices may change according to the finishes selected by the client and / or changes in the quantities requested. </p>
                                     <p>* The prices of this quote do not include bonds </p>
                                </div>                                
                                <div class="row" id="termns">
                                    <br/><span t-raw="doc.note"/><br/>
                                </div>
                                <div>
                                    <table class="col-12 text-center" style="border:0px;">
                                        <tr>
                                            <td t-foreach="doc.message_follower_ids" t-as="follower">
                                                <span t-if="follower.partner_id.function in ['Project manager','project manager']" t-esc="follower.partner_id.name"/>
                                            </td>
                                            <td>_________________________________</td>
                                        </tr>
                                        <tr>
                                            <td>Project Manager</td>
                                            <td/>                                            
                                        </tr>
                                        <tr>
                                            <td t-foreach="doc.message_follower_ids" t-as="follower">
                                                <span t-if="follower.partner_id.function in ['Project manager','project manager']" t-esc="follower.partner_id.email"/>
                                            </td>
                                            <td>
                                                I accept quotation, terms and Conditions
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </t>
                <div class="footer">
                    <div class="row" style="background-color: #F04E23; height: 4px; width: 1000px;"/>
                    <div class="pull-left">
                            <div class="text-center" style="margin-left:350px; font-size:12px;">
                                <span t-field="res_company.website"/><br/>
                                <span t-field="res_company.street"/>,
                                <span t-field="res_company.city"/>
                                <span t-field="res_company.zip"/><br/>
                                <span t-field="res_company.phone"/><br/>
                            </div>
                    </div>
                    <div class="pull-right" style="height: 90px; width: 80px;">
                        <span t-field="res_company.logo" t-options="{'widget': 'image'}" role="img" t-att-aria-label="'Logo of %s' % res_company.name" t-att-title="res_company.name"/>
                    </div>
                </div>
            </t>
        </xpath>
    </template>
</odoo>
