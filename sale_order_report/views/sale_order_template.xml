<?xml version="1.0"?>
<odoo>
    <template id="report_sale_order_external_for_iho" inherit_id="sale.report_saleorder_document">
        <xpath expr="//t/t[1]" position="replace">            
            <t t-set="doc" t-value="doc.with_context({'lang':doc.partner_id.lang})" />
            <t t-call="web.html_container">
                <div class="header">
                    <div/>
                </div>
                <t t-call="web.internal_layout">
                    <div>
                        <div style="height: 80px; width: 150px;">
                            <span t-field="res_company.logo" t-options="{'widget': 'image'}" role="img" t-att-aria-label="'Logo of %s' % res_company.name" t-att-title="res_company.name"/>
                        </div>
                        <div class="row" style="padding-top:16px;padding-button:16px;">
                            <div class="col-6 pull-left">
                                <div style="padding:-4px; margin:-4px;"><strong>Partner: </strong><span t-field="doc.partner_id"/><br/></div>
                                <div style="padding:-4px; margin:-4px;"><strong>Address: </strong><span t-field="doc.partner_id.street"/><br/></div>
                                <div style="padding:-4px; margin:-4px;"><strong>Email: </strong><span t-field="doc.partner_id.email"/><br/></div>
                                <div style="padding:-4px; margin:-4px;"><strong>Phone: </strong><span t-field="doc.partner_id.phone"/><br/></div>
                                <div style="padding:-4px; margin:-4px;"><strong>Quotation: </strong><span t-field="doc.name"/><br/></div>
                                <div style="padding:-4px; margin:-4px;"><strong>Date: </strong><span t-field="doc.create_date"/><br/><br/></div>
                            </div>
                        </div>
                    </div>
                    <div class="page">
                        <!-- Is there a discount on at least one line? -->
                        <t t-set="display_discount" t-value="any([l.discount for l in doc.order_line])"/>
                        <div class="row">
                            <table class="table table-xs table-bordered" style="font-size:12px;">
                                <thead>
                                    <tr style="background-color: #F04E23; color: #ffffff;">
                                        <th class="text-left" style="width: 10px;"><strong>Item</strong></th>
                                        <th class="text-center"><strong>Quantity</strong></th>
                                        <th class="text-center"><strong>Code</strong></th>
                                        <th class="text-left"><strong>Description</strong></th>
                                        <th class="text-center"><strong>photo</strong></th>
                                        <th class="text-right"><strong>Unit Price</strong></th>
                                        <th class="text-right"><strong>Total Price</strong></th>
                                    </tr>
                                </thead>
                                <tbody class="sale_tbody">
                                    <t t-set="current_subtotal" t-value="0"/>
                                    <t t-set="row_count" t-value="1"/>
                                    <t t-foreach="doc.order_line" t-as="line">
                                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>
                                        <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                                            <t t-if="not line.display_type">
                                                <td><span t-esc="row_count"/></td>
                                                <td class="text-right">
                                                    <span t-field="line.product_uom_qty"/>
                                                    <span t-field="line.product_uom" groups="uom.group_uom"/>
                                                </td>
                                                <td><span t-field="line.product_id.code"/></td>
                                                <td><span t-field="line.name"/></td>
                                                <td><span t-field="line.product_id.image_medium" t-options="{'widget': 'image'}" role="img"/></td>
                                                <td class="text-right">
                                                    <span t-field="line.price_unit"/>
                                                </td>
                                                <td class="text-right o_price_total">
                                                    <span t-field="line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                                                    <span t-field="line.price_total" groups="account.group_show_line_subtotals_tax_included"/>
                                                </td>
                                            </t>
                                            <t t-if="line.display_type == 'line_note'">
                                                <td t-att-colspan="colspan">
                                                    <span t-field="line.name"/>
                                                </td>
                                            </t>
                                        </tr>
                                        <t t-if="current_section and (line_last or doc.order_line[line_index+1].display_type == 'line_section')">
                                            <tr class="is-subtotal text-right">
                                                <td t-att-colspan="colspan">
                                                    <strong class="mr16">Subtotal</strong>
                                                    <span
                                                        t-esc="current_subtotal"
                                                        t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'
                                                    />
                                                </td>
                                            </tr>
                                        </t>
                                        <tr t-if="line.display_type == 'line_section'">
                                            <td colspan="7">
                                                <span t-field="line.image_sol" t-options="{'widget': 'image'}" role="img"/>
                                            </td>
                                        </tr>
                                        <t t-set="row_count" t-value="row_count+1"/>
                                    </t>
                                </tbody>
                            </table>
                        </div>
                        <div name="payment_term"/>
                        <div class="col-6 pull-right">
                            <table class="table table-xs table-condensed"  style="font-size:12px;">
                                <tr class="border-black o_subtotal">
                                    <td><strong>Subtotal</strong></td>
                                    <td class="text-right">
                                        <span t-field="doc.amount_untaxed"/>
                                    </td>
                                </tr>
                                <t t-foreach="doc.amount_by_group" t-as="amount_by_group">
                                    <tr style="">
                                        <t t-if="amount_by_group[3] == 1 and doc.amount_untaxed == amount_by_group[2]">
                                            <td>
                                                <span t-esc="amount_by_group[0]"/>
                                                <span>&amp;nbsp;<span>on</span>&amp;nbsp;<t t-esc="amount_by_group[2]" t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/></span>
                                            </td>
                                            <td class="text-right o_price_total">
                                                <span t-esc="amount_by_group[1]"
                                                    t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/>
                                            </td>
                                        </t>
                                        <t t-else ="">
                                            <td>
                                                <span t-esc="amount_by_group[0]"/>
                                            </td>
                                            <td class="text-right o_price_total">
                                                <span t-esc="amount_by_group[1]"
                                                    t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/>
                                            </td>
                                        </t>
                                    </tr>
                                </t>
                                <tr class="border-black o_total">
                                    <td><strong>Total</strong></td>
                                    <td class="text-right">
                                        <span t-field="doc.amount_total"/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="row" id="termns">
                            <span t-raw="doc.note"/>
                        </div>
                     </div>
                </t>
                <div class="footer">
                    <div class="row" style="background-color: #F04E23; height: 4px; width: 1000px;"/>
                    <div class="pull-right" style="height: 90px; width: 80px;">
                        <span t-field="res_company.logo" t-options="{'widget': 'image'}" role="img" t-att-aria-label="'Logo of %s' % res_company.name" t-att-title="res_company.name"/>
                    </div>
                </div>
            </t>
        </xpath>
    </template>
</odoo>
